{% extends 'projects/base.html' %}

{% block content %}

<h1>Report from {{ from }} to {{ to }}</h1>

{% if clients %}
<p>Subsetted for Clients:</p>
  <ul>
    {% for client in clients %}
      <li>{{ client }}</li>
    {% endfor %}
  </ul>
{% endif %}

{% if projects %}
<p>Subsetted for Projects:</p>
  <ul>
    {% for project in projects %}
      <li>{{ project }}</li>
    {% endfor %}
  </ul>
{% endif %}

{% if sessions %}

<h2 class="text-center">Total earned: {{ total_earned | floatformat:"2" }}€</h2>

<table class="table table-condensed table-hover table-bordered table-striped">

  <thead>
    <tr>
      <th scope="col">Session Date</th>
      <th scope="col">Client</th>
      <th scope="col">Units</th>
      <th scope="col">Earned</th>
    </tr>
  </thead>

  {% for today, todays_sessions in sessions_per_date.items %}
  <tr{% if today.weekday > 4 %} class="weekend"{% endif %}>
    <td>
      {{ today }}
    </td>
    <td>
      {% for session in todays_sessions %}
        {{ session.project.client }} <br />
      {% endfor %}
    </td>
    <td>
      {% for session in todays_sessions %}
        {{ session.units_worked | floatformat:"-2" }} {{ session.project.rate_unit }}{% if session.units_worked != 1 %}s{% endif %} <br />
      {% endfor %}
    </td>
    <td align="right">
      {% for session in todays_sessions %}
      <a href="{% url 'projects:session-detail' session.id %}">
        {{ session.get_money_earned | floatformat:"2" }}€
      </a> <br />
      {% endfor %}
    </td>
  </tr>
  {% endfor %}
</table>
{% else %}
<p>Selected timespan had no sessions. You lazy!</p>
{% endif %}

{% endblock %}
